

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Fixtures &mdash; Ckan API client 0.1a documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:'../',
        VERSION:'0.1a',
        COLLAPSE_INDEX:false,
        FILE_SUFFIX:'.html',
        HAS_SOURCE:  true
      };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
    <link rel="top" title="Ckan API client 0.1a documentation" href="../index.html"/>
        <link rel="up" title="Testing" href="index.html"/>
        <link rel="next" title="Testing utilities" href="utility.html"/>
        <link rel="prev" title="Testing" href="index.html"/> 

  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../index.html" class="icon icon-home"> Ckan API client</a>
        <form class="wy-form" action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search docs" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../clients/index.html">Clients</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../clients/low-level.html">Low-level</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/high-level.html">High-level</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/syncing.html">Syncing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules/index.html">Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/exceptions.html">ckan_api_client.exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/objects.html">ckan_api_client.objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/utils.html">ckan_api_client.utils</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Testing</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">Fixtures</a></li>
<li class="toctree-l2"><a class="reference internal" href="utility.html">Testing utilities</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top">
        <i data-toggle="wy-nav-top" class="icon icon-reorder"></i>
        <a href="/">Ckan API client</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <ul class="wy-breadcrumbs">
  <li><a href="../index.html">Docs</a> &raquo;</li>
  <li><a href="">Fixtures</a></li>
  
</ul>
<hr/>

          
  <div class="section" id="fixtures">
<h1>Fixtures<a class="headerlink" href="#fixtures" title="Permalink to this headline">¶</a></h1>
<p>Documentation of the available fixtures for tests.</p>
<span class="target" id="module-ckan_api_client.tests.conftest"></span><div class="section" id="fixture-functions">
<h2>Fixture functions<a class="headerlink" href="#fixture-functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ckan_api_client.tests.conftest.ckan_env">
<tt class="descclassname">ckan_api_client.tests.conftest.</tt><tt class="descname">ckan_env</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#ckan_env"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.ckan_env" title="Permalink to this definition">¶</a></dt>
<dd><p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">test_example</span><span class="p">(</span><span class="n">ckan_env</span><span class="p">):</span>
    <span class="n">instance</span> <span class="o">=</span> <span class="n">ckan_env</span><span class="o">.</span><span class="n">create_instance</span><span class="p">()</span>

    <span class="k">with</span> <span class="n">instance</span><span class="o">.</span><span class="n">serve</span><span class="p">()</span> <span class="k">as</span> <span class="n">server</span><span class="p">:</span>
        <span class="c"># Now make the client connect to ``server.url``</span>

        <span class="c"># If you need an API key:</span>
        <span class="n">api_key</span> <span class="o">=</span> <span class="n">ckan_env</span><span class="o">.</span><span class="n">get_sysadmin_api_key</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A configured Ckan environment object, ready for use</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#ckan_api_client.tests.conftest.CkanEnvironment" title="ckan_api_client.tests.conftest.CkanEnvironment"><tt class="xref py py-class docutils literal"><span class="pre">CkanEnvironment</span></tt></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ckan_api_client.tests.conftest.ckan_instance">
<tt class="descclassname">ckan_api_client.tests.conftest.</tt><tt class="descname">ckan_instance</tt><big>(</big><em>request</em>, <em>ckan_env</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#ckan_instance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.ckan_instance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ckan_api_client.tests.conftest.ckan_url">
<tt class="descclassname">ckan_api_client.tests.conftest.</tt><tt class="descname">ckan_url</tt><big>(</big><em>request</em>, <em>ckan_instance</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#ckan_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.ckan_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Create &amp; launch a Ckan instance; return a URL at which
it is accessible.</p>
<p>Note this would only work for read-only access, as there is no
way to get an authentication key too..</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">URL to access the instance</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">basestring</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ckan_api_client.tests.conftest.data_dir">
<tt class="descclassname">ckan_api_client.tests.conftest.</tt><tt class="descname">data_dir</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#data_dir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.data_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Return path to the data directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><tt class="xref py py-class docutils literal"><span class="pre">py.path.local</span></tt></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ckan_api_client.tests.conftest.ckan_client_ll">
<tt class="descclassname">ckan_api_client.tests.conftest.</tt><tt class="descname">ckan_client_ll</tt><big>(</big><em>request</em>, <em>ckan_instance</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#ckan_client_ll"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.ckan_client_ll" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A low-level client attached to a running Ckan</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="../clients/low-level.html#ckan_api_client.low_level.CkanLowlevelClient" title="ckan_api_client.low_level.CkanLowlevelClient"><tt class="xref py py-class docutils literal"><span class="pre">ckan_api_client.low_level.CkanLowlevelClient</span></tt></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ckan_api_client.tests.conftest.ckan_client_hl">
<tt class="descclassname">ckan_api_client.tests.conftest.</tt><tt class="descname">ckan_client_hl</tt><big>(</big><em>request</em>, <em>ckan_instance</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#ckan_client_hl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.ckan_client_hl" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A high-level client attached to a running Ckan</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="../clients/high-level.html#ckan_api_client.high_level.CkanHighlevelClient" title="ckan_api_client.high_level.CkanHighlevelClient"><tt class="xref py py-class docutils literal"><span class="pre">ckan_api_client.high_level.CkanHighlevelClient</span></tt></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ckan_api_client.tests.conftest.ckan_client_sync">
<tt class="descclassname">ckan_api_client.tests.conftest.</tt><tt class="descname">ckan_client_sync</tt><big>(</big><em>request</em>, <em>ckan_instance</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#ckan_client_sync"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.ckan_client_sync" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A synchronization client attached to a running Ckan</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="../clients/syncing.html#ckan_api_client.syncing.SynchronizationClient" title="ckan_api_client.syncing.SynchronizationClient"><tt class="xref py py-class docutils literal"><span class="pre">ckan_api_client.syncing.SynchronizationClient</span></tt></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="utility-objects">
<h2>Utility objects<a class="headerlink" href="#utility-objects" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ckan_api_client.tests.conftest.CkanEnvironment">
<em class="property">class </em><tt class="descclassname">ckan_api_client.tests.conftest.</tt><tt class="descname">CkanEnvironment</tt><big>(</big><em>venv_root</em>, <em>pgsql_admin_url</em>, <em>solr_url</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanEnvironment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanEnvironment" title="Permalink to this definition">¶</a></dt>
<dd><p>Class providing functionality to manage a Ckan installation.</p>
<p>This manages:</p>
<ul class="simple">
<li>the virtualenv</li>
<li>ckan instance creation</li>
<li>database and solr operations</li>
</ul>
<dl class="classmethod">
<dt id="ckan_api_client.tests.conftest.CkanEnvironment.from_environment">
<em class="property">classmethod </em><tt class="descname">from_environment</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanEnvironment.from_environment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanEnvironment.from_environment" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternate constructor: initializes configuration
by reading environment variables.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">CKAN_VIRTUALENV</span></tt> will be used as the virtualenv
in which Ckan is installed (may differ from current
virtualenv!).</li>
<li><tt class="docutils literal"><span class="pre">CKAN_POSTGRES_ADMIN</span></tt> url with administrative
credentials to be used to access PostgreSQL.
Example: <tt class="docutils literal"><span class="pre">postgresql://postgres:pass&#64;localhost/postgres</span></tt></li>
<li><tt class="docutils literal"><span class="pre">SOLR_URL</span></tt> url of the solr index to use.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanEnvironment.create_instance">
<tt class="descname">create_instance</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanEnvironment.create_instance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanEnvironment.create_instance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanEnvironment.get_command">
<tt class="descname">get_command</tt><big>(</big><em>name</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanEnvironment.get_command"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanEnvironment.get_command" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full path of a command inside the virtualenv</p>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanEnvironment.run_paster">
<tt class="descname">run_paster</tt><big>(</big><em>*args</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanEnvironment.run_paster"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanEnvironment.run_paster" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a paster command in the virtualenv.</p>
<p>Arguments will be passed to the paster command invocation.</p>
<p>Executed command will be something like:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;venv&gt;/bin/python &lt;venv&gt;/bin/paster --plugin=ckan [&lt;args&gt; ..]
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanEnvironment.get_postgres_admin_credentials">
<tt class="descname">get_postgres_admin_credentials</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanEnvironment.get_postgres_admin_credentials"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanEnvironment.get_postgres_admin_credentials" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanEnvironment.make_postgres_url">
<tt class="descname">make_postgres_url</tt><big>(</big><em>user</em>, <em>password</em>, <em>host</em>, <em>port</em>, <em>database</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanEnvironment.make_postgres_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanEnvironment.make_postgres_url" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanEnvironment.get_postgres_admin_connection">
<tt class="descname">get_postgres_admin_connection</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanEnvironment.get_postgres_admin_connection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanEnvironment.get_postgres_admin_connection" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">administrative connection to database</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">psycopg2.connect()</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanEnvironment.get_postgres_connection">
<tt class="descname">get_postgres_connection</tt><big>(</big><em>username</em>, <em>password</em>, <em>database</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanEnvironment.get_postgres_connection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanEnvironment.get_postgres_connection" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">&#8220;user&#8221; connection to database</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">psycopg2.connect()</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanEnvironment.create_db_user">
<tt class="descname">create_db_user</tt><big>(</big><em>username</em>, <em>password</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanEnvironment.create_db_user"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanEnvironment.create_db_user" title="Permalink to this definition">¶</a></dt>
<dd><p>Create PostgreSQL user, for use by Ckan</p>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanEnvironment.create_db">
<tt class="descname">create_db</tt><big>(</big><em>name</em>, <em>owner</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanEnvironment.create_db"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanEnvironment.create_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Create PostgreSQL database, for use by Ckan</p>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanEnvironment.drop_db_user">
<tt class="descname">drop_db_user</tt><big>(</big><em>username</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanEnvironment.drop_db_user"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanEnvironment.drop_db_user" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete previously created PostgreSQL user, to cleanup
after running tests.</p>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanEnvironment.drop_db">
<tt class="descname">drop_db</tt><big>(</big><em>name</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanEnvironment.drop_db"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanEnvironment.drop_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete previously created PostgreSQL database, to cleanup
after running tests.</p>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanEnvironment.flush_solr_index">
<tt class="descname">flush_solr_index</tt><big>(</big><em>solr_url=None</em>, <em>site_id=None</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanEnvironment.flush_solr_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanEnvironment.flush_solr_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Completely flush the configured Solr index.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">since Ckan supports sharing the same index between
installations, we don&#8217;t actually delete <em>everything</em>
from the index, but instead issued a delete on query:
<tt class="docutils literal"><span class="pre">+site_id:&quot;&lt;ckan-site-id&gt;&quot;</span></tt></p>
</div>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanEnvironment.create_configuration_file">
<tt class="descname">create_configuration_file</tt><big>(</big><em>file_name</em>, <em>extra=None</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanEnvironment.create_configuration_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanEnvironment.create_configuration_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a configuration file for Ckan.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">CkanConfFileWrapper associated to conf file</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanEnvironment.teardown">
<tt class="descname">teardown</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanEnvironment.teardown"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanEnvironment.teardown" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="ckan_api_client.tests.conftest.CkanInstance">
<em class="property">class </em><tt class="descclassname">ckan_api_client.tests.conftest.</tt><tt class="descname">CkanInstance</tt><big>(</big><em>virtualenv</em>, <em>conf</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for a Ckan instance.</p>
<p>Based on:</p>
<ul class="simple">
<li>a virtualenv</li>
<li>a Ckan configuration file</li>
</ul>
<dl class="attribute">
<dt id="ckan_api_client.tests.conftest.CkanInstance.venv_root">
<tt class="descname">venv_root</tt><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.venv_root"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.venv_root" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ckan_api_client.tests.conftest.CkanInstance.server_host">
<tt class="descname">server_host</tt><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.server_host"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.server_host" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ckan_api_client.tests.conftest.CkanInstance.server_port">
<tt class="descname">server_port</tt><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.server_port"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.server_port" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ckan_api_client.tests.conftest.CkanInstance.server_url">
<tt class="descname">server_url</tt><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.server_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.server_url" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ckan_api_client.tests.conftest.CkanInstance.configuration_file">
<tt class="descname">configuration_file</tt><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.configuration_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.configuration_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ckan_api_client.tests.conftest.CkanInstance.database_url">
<tt class="descname">database_url</tt><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.database_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.database_url" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ckan_api_client.tests.conftest.CkanInstance.database_name">
<tt class="descname">database_name</tt><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.database_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.database_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ckan_api_client.tests.conftest.CkanInstance.database_username">
<tt class="descname">database_username</tt><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.database_username"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.database_username" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ckan_api_client.tests.conftest.CkanInstance.database_password">
<tt class="descname">database_password</tt><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.database_password"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.database_password" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ckan_api_client.tests.conftest.CkanInstance.solr_url">
<tt class="descname">solr_url</tt><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.solr_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.solr_url" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ckan_api_client.tests.conftest.CkanInstance.site_id">
<tt class="descname">site_id</tt><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.site_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.site_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ckan_api_client.tests.conftest.CkanInstance.storage_path">
<tt class="descname">storage_path</tt><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.storage_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.storage_path" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanInstance.run_paster">
<tt class="descname">run_paster</tt><big>(</big><em>*a</em>, <em>**kw</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.run_paster"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.run_paster" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanInstance.get_command">
<tt class="descname">get_command</tt><big>(</big><em>*a</em>, <em>**kw</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.get_command"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.get_command" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanInstance.run_paster_with_conf">
<tt class="descname">run_paster_with_conf</tt><big>(</big><em>command</em>, <em>*args</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.run_paster_with_conf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.run_paster_with_conf" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a paster command in the virtualenv, adding &#8211;config=ckan.ini</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>command</strong> &#8211; the paster command to be run</li>
<li><strong>args</strong> &#8211; other arguments will be passed to the command</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Executed command will be something like:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;venv&gt;/bin/python &lt;venv&gt;/bin/paster --plugin=ckan \
    &lt;command&gt; --config=&lt;venv&gt;/etc/ckan/ckan.ini [&lt;args&gt; ..]
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanInstance.serve">
<tt class="descname">serve</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.serve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.serve" title="Permalink to this definition">¶</a></dt>
<dd><p>Start the Ckan server, using <tt class="docutils literal"><span class="pre">paster</span> <span class="pre">serve</span></tt> command.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><tt class="xref py py-class docutils literal"><span class="pre">CkanServerWrapper</span></tt></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanInstance.get_postgres_connection">
<tt class="descname">get_postgres_connection</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.get_postgres_connection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.get_postgres_connection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanInstance.paster_db_init">
<tt class="descname">paster_db_init</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.paster_db_init"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.paster_db_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize database, by calling paster command</p>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanInstance.paster_search_index_rebuild">
<tt class="descname">paster_search_index_rebuild</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.paster_search_index_rebuild"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.paster_search_index_rebuild" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebuild search index, by calling paster command</p>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanInstance.paster_user_add">
<tt class="descname">paster_user_add</tt><big>(</big><em>name</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.paster_user_add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.paster_user_add" title="Permalink to this definition">¶</a></dt>
<dd><p>Create Ckan user, by calling paster command</p>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanInstance.paster_user_remove">
<tt class="descname">paster_user_remove</tt><big>(</big><em>name</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.paster_user_remove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.paster_user_remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove Ckan user, by calling paster command</p>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanInstance.paster_sysadmin_add">
<tt class="descname">paster_sysadmin_add</tt><big>(</big><em>name</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.paster_sysadmin_add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.paster_sysadmin_add" title="Permalink to this definition">¶</a></dt>
<dd><p>Grant sysadmin privileges to a Ckan user,
by calling paster command.</p>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanInstance.paster_sysadmin_remove">
<tt class="descname">paster_sysadmin_remove</tt><big>(</big><em>name</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.paster_sysadmin_remove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.paster_sysadmin_remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Revoke sysadmin privileges from a Ckan user,
by calling paster command.</p>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanInstance.get_sysadmin_api_key">
<tt class="descname">get_sysadmin_api_key</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.get_sysadmin_api_key"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.get_sysadmin_api_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a sysadmin user (with random name / password)
and return its API key.</p>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.CkanInstance.teardown">
<tt class="descname">teardown</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#CkanInstance.teardown"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.CkanInstance.teardown" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="ckan_api_client.tests.conftest.ConfFileWrapper">
<em class="property">class </em><tt class="descclassname">ckan_api_client.tests.conftest.</tt><tt class="descname">ConfFileWrapper</tt><big>(</big><em>filename</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#ConfFileWrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.ConfFileWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for Ckan configuration files, providing
some additional functionality.</p>
<dl class="method">
<dt id="ckan_api_client.tests.conftest.ConfFileWrapper.get_conf_parser">
<tt class="descname">get_conf_parser</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#ConfFileWrapper.get_conf_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.ConfFileWrapper.get_conf_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a RawConfigParser instance, with configuration loaded
from the wrapped configuration file.</p>
<p>Not caching this as we want to reload any changes that should
have occurred on the file..</p>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.ConfFileWrapper.set">
<tt class="descname">set</tt><big>(</big><em>section</em>, <em>option</em>, <em>value</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#ConfFileWrapper.set"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.ConfFileWrapper.set" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a configuration option</p>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.ConfFileWrapper.get">
<tt class="descname">get</tt><big>(</big><em>section</em>, <em>option</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#ConfFileWrapper.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.ConfFileWrapper.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a configuration option</p>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.ConfFileWrapper.delete">
<tt class="descname">delete</tt><big>(</big><em>section</em>, <em>option</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#ConfFileWrapper.delete"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.ConfFileWrapper.delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a configuration option</p>
</dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.ConfFileWrapper.update">
<tt class="descname">update</tt><big>(</big><em>data</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#ConfFileWrapper.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.ConfFileWrapper.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update configuration.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<em>dict</em>) &#8211; dict of dicts: <tt class="docutils literal"><span class="pre">{section:</span> <span class="pre">{option:</span> <span class="pre">value}}</span></tt></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ckan_api_client.tests.conftest.ProcessWrapper">
<em class="property">class </em><tt class="descclassname">ckan_api_client.tests.conftest.</tt><tt class="descname">ProcessWrapper</tt><big>(</big><em>args</em>, <em>waitstart=None</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#ProcessWrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.ProcessWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="ckan_api_client.tests.conftest.ProcessWrapper.start">
<tt class="descname">start</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#ProcessWrapper.start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.ProcessWrapper.start" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ckan_api_client.tests.conftest.ProcessWrapper.stop">
<tt class="descname">stop</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#ProcessWrapper.stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.ProcessWrapper.stop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="utility-functions">
<h2>Utility functions<a class="headerlink" href="#utility-functions" title="Permalink to this headline">¶</a></h2>
<p>Functions used by fixtures.</p>
<dl class="function">
<dt id="ckan_api_client.tests.conftest.check_tcp_port">
<tt class="descclassname">ckan_api_client.tests.conftest.</tt><tt class="descname">check_tcp_port</tt><big>(</big><em>host</em>, <em>port</em>, <em>timeout=3</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#check_tcp_port"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.check_tcp_port" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether a given TCP port is reachable</p>
</dd></dl>

<dl class="function">
<dt id="ckan_api_client.tests.conftest.wait_net_service">
<tt class="descclassname">ckan_api_client.tests.conftest.</tt><tt class="descname">wait_net_service</tt><big>(</big><em>host</em>, <em>port</em>, <em>timeout</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#wait_net_service"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.wait_net_service" title="Permalink to this definition">¶</a></dt>
<dd><p>Wait for network service to appear</p>
<p>Based on: <a class="reference external" href="http://code.activestate.com/recipes/576655/">http://code.activestate.com/recipes/576655/</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>timeout</strong> &#8211; in seconds</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True of False, if timeout is None may return only True or
throw unhandled network exception</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ckan_api_client.tests.conftest.discover_available_port">
<tt class="descclassname">ckan_api_client.tests.conftest.</tt><tt class="descname">discover_available_port</tt><big>(</big><em>minport=5000</em>, <em>maxport=9000</em><big>)</big><a class="reference internal" href="../_modules/ckan_api_client/tests/conftest.html#discover_available_port"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ckan_api_client.tests.conftest.discover_available_port" title="Permalink to this definition">¶</a></dt>
<dd><p>Find an available TCP port in the specified range</p>
</dd></dl>

</div>
</div>


          <footer>
  
    <div class="rst-footer-buttons">
      
        <a href="utility.html" class="btn btn-neutral float-right" title="Testing utilities"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Testing"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <p>
      &copy; Copyright 2014, Trento RISE.
  </p>

  <a href="https://www.github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="http://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  

</body>
</html>